FROM debian:jessie
MAINTAINER iwamura

# Modify sources.list for using mirror site
RUN (echo deb http://cdn.debian.net/debian jessie main; \
     echo deb http://cdn.debian.net/debian jessie-updates main; \
     echo deb http://security.debian.org jessie/updates main) > /etc/apt/sources.list

# Install packages
RUN apt-get update && apt-get -y --no-install-recommends install \
        xinetd \
    &&\
    rm -r /var/cache/apt /var/lib/apt/lists

# Create user and working directory to build
RUN useradd treewalker

COPY treewalker-root.tgz /tmp/
RUN cd /opt &&\
    tar --no-same-owner -xvf /tmp/treewalker-root.tgz &&\
    rm -f /tmp/treewalker-root.tgz
COPY treewalker_conf /etc/xinetd.d/
COPY flag.txt /opt/treewalker-root/

COPY start.sh /root/

EXPOSE 10000

#CMD ["/usr/sbin/xinetd", "-dontfork"]
#CMD ["/root/start.sh"]
CMD ["/bin/bash"]

